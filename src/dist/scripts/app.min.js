var theForm=document.querySelector("form#story-search"),searchButton=document.querySelector("form#story-search > button"),theInput=document.querySelector("form#story-search > fieldset"),searchField=document.querySelector("form#story-search > fieldset input"),isShown=!1;function toggleSearchForm(){isShown=isShown?(theInput.classList.remove("show"),searchButton.classList.remove("hide"),event.preventDefault(),!1):(theInput.classList.add("show"),searchButton.classList.add("hide"),searchField.focus(),event.preventDefault(),!0)}theForm.addEventListener("click",toggleSearchForm);var theFilter=document.querySelector("form#filter"),filterButton=document.querySelector("header > nav button"),buttonStripes=document.querySelectorAll("header > nav button > span");function toggleFilter(){theFilter.classList.toggle("show"),buttonStripes.forEach(function(e){e.classList.toggle("is-open")}),document.body.classList.toggle("noScroll")}function checkUserInput(e){return searchField.value}function returnParent(e){return e.parentElement}function returnGrandParent(e){return returnParent(e).parentElement}function returnArticle(e){return returnGrandParent(e).parentElement}filterButton.addEventListener("click",toggleFilter);var allTitles=document.querySelectorAll(".stories article h4");function checkAmountOfVisibleTitles(){for(var e=[],t=0;t<allTitles.length;t++)returnArticle(allTitles[t]).classList.contains("visually-hidden")||e.push(allTitles[t]);return e.length}function checkVisibleTitlesPerGenre(e){for(var t=document.getElementsByClassName(e),l=[],i=0;i<t.length;i++)t[i].classList.contains("visually-hidden")||l.push(t[i]);return l.length}function getAllStoriesInGenre(e){return document.getElementsByClassName(e).length}var results=document.querySelector("#results"),resultsSection=document.querySelector("#resultsSection"),fallBackButton=document.querySelector("#fallBackButton");function fixInput(){document.querySelectorAll(".droomVerhaal").forEach(function(e){e.classList.remove("visually-hidden")}),allGenreStoryTitles?allGenreStoryTitles.forEach(function(e){e.classList.remove("visually-hidden")}):downloadsTitle?downloadsTitle.classList.remove("visually-hidden"):resultsTitle&&resultsTitle.classList.remove("visually-hidden"),searchField.focus()}fallBackButton&&fallBackButton.addEventListener("click",fixInput);var firstStoriesTitle=document.querySelector("#chaotischTitle"),secondStoriesTitle=document.querySelector("#humorTitle"),thirdStoriesTitle=document.querySelector("#horrorTitle"),fourthStoriesTitle=document.querySelector("#liefdeTitle"),downloadsTitle=document.querySelector("#downloadsTitle"),likesTitle=document.querySelector("#likesTitle"),resultsTitle=document.querySelector("#resultsTitle"),allGenreStoryTitles=[firstStoriesTitle,secondStoriesTitle,thirdStoriesTitle,fourthStoriesTitle];function filterStories(t){checkUserInput(),checkAmountOfVisibleTitles(),checkVisibleTitlesPerGenre("chaotischVerhaal"),checkVisibleTitlesPerGenre("humorVerhaal"),checkVisibleTitlesPerGenre("horrorVerhaal"),checkVisibleTitlesPerGenre("liefdeVerhaal"),checkVisibleTitlesPerGenre("gedownloadVerhaal"),checkVisibleTitlesPerGenre("likedVerhaal"),checkVisibleTitlesPerGenre("resultaatVerhaal"),t=checkUserInput();var e=checkAmountOfVisibleTitles(),l=checkVisibleTitlesPerGenre("chaotischVerhaal"),i=checkVisibleTitlesPerGenre("humorVerhaal"),s=checkVisibleTitlesPerGenre("horrorVerhaal"),r=checkVisibleTitlesPerGenre("liefdeVerhaal"),o=checkVisibleTitlesPerGenre("gedownloadVerhaal"),n=checkVisibleTitlesPerGenre("likedVerhaal"),a=checkVisibleTitlesPerGenre("resultaatVerhaal");firstStoriesTitle&&secondStoriesTitle&&thirdStoriesTitle&&fourthStoriesTitle&&(firstStoriesTitle?(firstStoriesTitle.textContent="Chaotisch ("+l+")",secondStoriesTitle.textContent="Humor ("+i+")",thirdStoriesTitle.textContent="Horror ("+s+")",fourthStoriesTitle.textContent="Liefde ("+r+")"):downloadsTitle?(downloadsTitle.textContent="Gedownloade verhalen ("+o+")",likesTitle.textContent="Gelikete verhalen ("+n+")"):resultsTitle&&(resultsTitle.textContent=a+" verhalen gevonden")),""===t?(e=allTitles.length,l=getAllStoriesInGenre("chaotischVerhaal"),i=getAllStoriesInGenre("humorVerhaal"),s=getAllStoriesInGenre("horrorVerhaal"),r=getAllStoriesInGenre("liefdeVerhaal"),o=getAllStoriesInGenre("gedownloadVerhaal"),n=getAllStoriesInGenre("likedVerhaal"),a=getAllStoriesInGenre("resultaatVerhaal"),results&&fallBackButton&&(results.classList.add("visually-hidden"),fallBackButton.classList.add("visually-hidden")),e>=allTitles.length&&allTitles.forEach(function(e){returnArticle(e).classList.remove("visually-hidden")}),allGenreStoryTitles?allGenreStoryTitles.forEach(function(e){e.classList.remove("visually-hidden")}):downloadsTitle?downloadsTitle.classList.remove("visually-hidden"):resultsTitle&&resultsTitle.classList.remove("visually-hidden")):t&&e<=allTitles.length&&1<=e?(results&&(results.classList.remove("visually-hidden"),results.textContent=e+" verhalen gevonden."),allTitles.forEach(function(e){e.textContent.toLowerCase().includes(t.toLowerCase())?returnArticle(e).classList.remove("visually-hidden"):returnArticle(e).classList.add("visually-hidden")})):(results&&fallBackButton&&(results.textContent="Oeps, we hebben geen resultaten kunnen vinden voor "+t+", bedoelde je misschien 'Droom'?",fallBackButton.classList.remove("visually-hidden"),fallBackButton.addEventListener("click",fixInput)),a=n=o=r=s=i=l=0,allGenreStoryTitles?allGenreStoryTitles.forEach(function(e){e.classList.add("visually-hidden")}):downloadsTitle?downloadsTitle.classList.add("visually-hidden"):resultsTitle&&resultsTitle.classList.add("visually-hidden"))}firstStoriesTitle&&secondStoriesTitle&&thirdStoriesTitle&&fourthStoriesTitle?(firstStoriesTitle.textContent="Chaotisch ("+getAllStoriesInGenre("chaotischVerhaal")+")",secondStoriesTitle.textContent="Humor ("+getAllStoriesInGenre("humorVerhaal")+")",thirdStoriesTitle.textContent="Horror ("+getAllStoriesInGenre("horrorVerhaal")+")",fourthStoriesTitle.textContent="Liefde ("+getAllStoriesInGenre("liefdeVerhaal")+")"):downloadsTitle&&likesTitle?(downloadsTitle.textContent="Gedownloade verhalen ("+getAllStoriesInGenre("gedownloadVerhaal")+")",likesTitle.textContent="Gelikete verhalen ("+getAllStoriesInGenre("likedVerhaal")+")"):resultsTitle&&(resultsTitle.textContent=getAllStoriesInGenre("resultaatVerhaal")+" verhalen gevonden"),searchField.addEventListener("input",filterStories),searchField.addEventListener("keydown",filterStories),searchField.addEventListener("keyup",filterStories);var downloadButtons=document.querySelectorAll("button#download"),melding=document.querySelector("body > div");function showMelding(e){melding.classList.add("show"),melding.classList.add(e)}function deleteMelding(){setTimeout(function(){melding.classList.remove("show")},4e3)}function loadingState(){var l=this,i=returnArticle(l).childNodes[1].childNodes[1].textContent;l.classList.add("loading"),setTimeout(function(){var t=new XMLHttpRequest,e=Math.round(1e4*Math.random());t.open("HEAD","https://picsum.photos/200/300?rand="+e,!0),t.send(),t.addEventListener("readystatechange",function(e){4==t.readyState&&(200<=t.status&&t.status<304?(l.classList.remove("loading"),l.classList.add("finished"),melding.classList.remove("error"),showMelding("success"),melding.childNodes[1].textContent="'"+i+"' is gedownload op dit apparaat",l.parentElement.nextElementSibling.textContent="Gedownload"):(l.classList.remove("loading"),l.classList.add("error"),melding.classList.remove("success"),showMelding("error"),melding.childNodes[1].textContent="Het downloaden van '"+i+"' is mislukt.",l.parentElement.nextElementSibling.textContent="Mislukt!"),deleteMelding())},!1)},3600)}for(i=0;i<downloadButtons.length;i++)downloadButtons[i].addEventListener("click",loadingState);var submitInput=document.querySelector('#sortOptions input[type="submit"]'),genreButton=document.querySelector("#sortOptions label"),surpriseButton=document.querySelector("#sortOptions label:last-of-type"),sections=document.querySelectorAll(".genre"),firstSection=document.querySelector(".stories:first-of-type"),secondSection=sections[1],thirdSection=sections[2],fourthSection=sections[3],allStories=document.querySelectorAll(".stories article"),firstStories=document.querySelectorAll(".stories:first-of-type article");function getRandomStory(){var e=Math.floor(Math.random()*allStories.length),t=allStories[e].cloneNode(!0);return t.classList.remove("chaotischVerhaal"),t.classList.remove("visually-hidden"),t}var isToggled=!1;function surpriseUser(){genreButton.classList.toggle("active"),surpriseButton.classList.toggle("active"),secondSection&&secondSection.classList.toggle("visually-hidden"),thirdSection&&(thirdSection.classList.toggle("visually-hidden"),fourthSection.classList.toggle("visually-hidden")),firstStories.forEach(function(e){e.classList.toggle("visually-hidden")});var e=document.querySelector(".stories:first-of-type article:last-child");isToggled?(firstStoriesTitle?firstStoriesTitle.textContent="Chaotisch ("+getAllStoriesInGenre("chaotischVerhaal")+")":downloadsTitle?downloadsTitle.textContent="Gedownloade verhalen ("+getAllStoriesInGenre("gedownloadVerhaal")+")":resultsTitle&&(resultsTitle.textContent="3 verhalen gevonden"),firstSection.removeChild(e),isToggled=!1):(firstStoriesTitle?firstStoriesTitle.textContent="Speciaal voor jou:":downloadsTitle?downloadsTitle.textContent="Speciaal voor jou:":resultsTitle&&(resultsTitle.textContent="Speciaal voor jou:"),isToggled=!0,firstSection.classList.toggle("loading"),setTimeout(function(){firstSection.classList.toggle("loading"),firstSection.appendChild(getRandomStory())},2e3)),event.preventDefault()}submitInput.addEventListener("click",surpriseUser);