var theForm=document.querySelector("form#story-search"),searchButton=document.querySelector("form#story-search > button"),theInput=document.querySelector("form#story-search > fieldset"),searchField=document.querySelector("form#story-search > fieldset input"),isShown=!1;function toggleSearchForm(){isShown=isShown?(theInput.classList.remove("show"),searchButton.classList.remove("hide"),event.preventDefault(),!1):(theInput.classList.add("show"),searchButton.classList.add("hide"),searchField.focus(),event.preventDefault(),!0)}theForm.addEventListener("click",toggleSearchForm);var theFilter=document.querySelector("form#filter"),filterButton=document.querySelector("header > nav button"),buttonStripes=document.querySelectorAll("header > nav button > span");function toggleFilter(){theFilter.classList.toggle("show"),buttonStripes.forEach(function(e){e.classList.toggle("is-open")}),document.body.classList.toggle("noScroll")}function checkUserInput(e){return searchField.value}function returnParent(e){return e.parentElement}function returnGrandParent(e){return returnParent(e).parentElement}function returnArticle(e){return returnGrandParent(e).parentElement}function getTitles(e){return document.querySelectorAll(".stories article h4")}filterButton.addEventListener("click",toggleFilter);var results=document.querySelector("#results"),resultsSection=document.querySelector("#resultsSection"),fallBackButton=document.querySelector("#fallBackButton");function fixInput(){searchField.value="Droom",filterStories()}fallBackButton&&fallBackButton.addEventListener("click",fixInput);var resultItems=document.getElementsByClassName("result");function filterStories(){checkUserInput(),getTitles();var t=checkUserInput();getTitles().forEach(function(e){results&&(results.classList.remove("visually-hidden"),results.textContent=resultItems.length+" verhalen gevonden."),""===t?(results.classList.add("visually-hidden"),fallBackButton&&fallBackButton.classList.add("visually-hidden"),returnArticle(e).classList.remove("visually-hidden")):e.textContent.toLowerCase().includes(t.toLowerCase())?(returnArticle(e).classList.remove("visually-hidden"),returnArticle(e).classList.add("result"),fallBackButton&&fallBackButton.classList.add("visually-hidden")):e.textContent.toLowerCase().includes(t.toLowerCase())||(returnArticle(e).classList.add("visually-hidden"),returnArticle(e).classList.remove("result"),fallBackButton&&fallBackButton.classList.remove("visually-hidden"),results&&(results.textContent="Oeps, we hebben geen resultaten kunnen vinden voor "+t+", bedoelde je misschien 'Droom'?"))})}searchField.addEventListener("input",filterStories);var downloadButtons=document.querySelectorAll("button#download"),melding=document.querySelector("body > div");function showMelding(e){melding.classList.add("show"),melding.classList.add(e)}function deleteMelding(){setTimeout(function(){melding.classList.remove("show")},4e3)}function loadingState(){var o=this,s=returnArticle(o).childNodes[1].childNodes[1].textContent;o.classList.add("loading"),setTimeout(function(){var t=new XMLHttpRequest,e=Math.round(1e4*Math.random());t.open("HEAD","https://picsum.photos/200/300?rand="+e,!0),t.send(),t.addEventListener("readystatechange",function(e){4==t.readyState&&(200<=t.status&&t.status<304?(o.classList.remove("loading"),o.classList.add("finished"),melding.classList.remove("error"),showMelding("success"),melding.childNodes[1].textContent="'"+s+"' is gedownload op dit apparaat",o.parentElement.nextElementSibling.textContent="Gedownload"):(o.classList.remove("loading"),o.classList.add("error"),melding.classList.remove("success"),showMelding("error"),melding.childNodes[1].textContent="Het downloaden van '"+s+"' is mislukt.",o.parentElement.nextElementSibling.textContent="Mislukt!"),deleteMelding())},!1)},3600)}for(i=0;i<downloadButtons.length;i++)downloadButtons[i].addEventListener("click",loadingState);var firstStories=document.querySelectorAll("body > section:nth-of-type(2) > section > article"),secondStories=document.querySelectorAll("body > section:nth-of-type(3) > section > article"),thirdStories=document.querySelectorAll("body > section:nth-of-type(4) > section > article"),fourthStories=document.querySelectorAll("body > section:nth-of-type(5) > section > article"),firstStoriesTitle=document.querySelector("#chaotischTitle"),secondStoriesTitle=document.querySelector("#humorTitle"),thirdStoriesTitle=document.querySelector("#horrorTitle"),fourthStoriesTitle=document.querySelector("#liefdeTitle"),allGenreTitles=[firstStoriesTitle,secondStoriesTitle,thirdStoriesTitle,fourthStoriesTitle];function storyChecker(e,t,o,s){t=[],e&&e.forEach(function(e){e.classList.contains("result")&&(t.push(e),o.textContent=s+" ("+t.length+")")})}function checkStories(){storyChecker(firstStories,[],firstStoriesTitle,"Chaotisch"),storyChecker(secondStories,[],secondStoriesTitle,"Humor"),storyChecker(thirdStories,[],thirdStoriesTitle,"Horror"),storyChecker(fourthStories,[],fourthStoriesTitle,"Liefde")}firstStoriesTitle&&(firstStoriesTitle.textContent="Chaotisch ("+firstStories.length+")"),secondStoriesTitle&&(secondStoriesTitle.textContent="Humor ("+secondStories.length+")"),thirdStoriesTitle&&(thirdStoriesTitle.textContent="Horror ("+thirdStories.length+")"),fourthStoriesTitle&&(fourthStoriesTitle.textContent="Liefde ("+fourthStories.length+")"),searchField.addEventListener("input",checkStories);var submitInput=document.querySelector('#sortOptions input[type="submit"]'),genreButton=document.querySelector("#sortOptions label"),surpriseButton=document.querySelector("#sortOptions label:last-of-type"),sections=document.querySelectorAll(".genre"),firstSection=document.querySelector(".stories:first-of-type"),secondSection=sections[1],thirdSection=sections[2],fourthSection=sections[3],allStories=document.querySelectorAll(".stories article");function getRandomStory(){var e=Math.round(Math.random()*allStories.length-1);return allStories[e].cloneNode(!0)}var isToggled=!1;function surpriseUser(){genreButton.classList.toggle("active"),surpriseButton.classList.toggle("active"),secondSection.classList.toggle("visually-hidden"),thirdSection.classList.toggle("visually-hidden"),fourthSection.classList.toggle("visually-hidden"),firstStories.forEach(function(e){e.classList.toggle("visually-hidden")});var e=document.querySelector(".stories:first-of-type article:last-child");isToggled?(firstStoriesTitle.textContent="Chaotisch ("+firstStories.length+")",firstSection.removeChild(e),isToggled=!1):(firstStoriesTitle.textContent="Speciaal voor jou:",isToggled=!0,firstSection.classList.toggle("loading"),setTimeout(function(){firstSection.classList.toggle("loading"),firstSection.appendChild(getRandomStory())},2e3)),event.preventDefault()}submitInput.addEventListener("click",surpriseUser);